<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<style>
   body{
    background-color: #333;
   } 
</style>
<svg viewBox="0 0 120 50" version="1.1" id="cb"
  xmlns="http://www.w3.org/2000/svg">
<style>
    .number {
      font: 5px sans-serif;
	  fill: white;
    }
    .tz {
      font: 2px sans-serif;
	  fill: gray;
    }
	#eus .tz {
      font: 2px sans-serif;
	  fill: #444;
    }
</style>
  <circle cx="24" cy="24" r="20"/>
  <text x="21" y="11" class="number">12</text>
  <text x="22.5" y="11" class="number">1</text>
  <text x="22.7" y="11" class="number">2</text>
  <text x="22.6" y="11" class="number">3</text>
  <text x="22.7" y="11" class="number">4</text>
  <text x="22.7" y="11" class="number">5</text>
  <text x="22.6" y="11" class="number">6</text>
  <text x="22.7" y="11" class="number">7</text>
  <text x="22.7" y="11" class="number">8</text>
  <text x="22.6" y="11" class="number">9</text>
  <text x="21" y="11" class="number">10</text>
  <text x="21" y="11" class="number">11</text>
  <rect x="23.95" y="10.3" width="0.1" height="0.7" id="ri" style="fill: gray;"/>
<g id="tzs">
  <g class="tz"><text x="22.8" y="14">ЕК</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.6" y="14">ОМ</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.8" y="14">НС</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.8" y="14">ИР</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.8" y="14">ЯК</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.8" y="14">ВЛ</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.8" y="14">МГ</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.8" y="14">ПК</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><circle cx="24" cy="13" r="0.7"/></g>
  <g class="tz"><text x="22.8" y="14">КЛ</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.6" y="14">МС</text><circle cx="24" cy="12" r="0.2"/></g>
  <g class="tz"><text x="22.6" y="14">СА</text><circle cx="24" cy="12" r="0.2"/></g>
  <g id="eus">
  <g class="tz"><text x="22.7" y="17">EE</text></g>
  <g class="tz"><text x="22.6" y="17">CE</text></g>
  <g class="tz"><text x="22.6" y="17">UK</text></g>
  <g class="tz"><text x="22.8" y="17">NY</text></g>
  <g class="tz"><text x="22.6" y="17">CH</text></g>
  <g class="tz"><text x="22.8" y="17">DE</text></g>
  <g class="tz"><text x="22.9" y="17">LA</text></g>
  </g>
  
</g>
  <rect x="23.4" y="15.2" width="1.2" height="8.8" id="ch" style="fill: white;"/>
  <rect x="23.7" y="12" width="0.6" height="12" id="mi" style="fill: white;"/>
  <rect x="23.9" y="11" width="0.2" height="14" id="se" style="fill: red;"/>
</svg>
<script>
//isDSTUS(new Date());
rotateNumbers();
rotateTzs();
createTicks();
setStrelki();
setInterval(setStrelki,1000);
if(window.location.search.includes("demo"))
	document.body.style.background = "#ddd";
if(!window.location.search.includes("eus"))
	document.querySelector("#eus").setAttribute("visibility", "hidden");
function rotateNumbers(){
var cs = document.querySelectorAll(".number");
for(var i =0; i < cs.length; i++) {
var deg = i*360/12;
cs[i].setAttribute("y",9.5);
rotateMe(cs[i], deg);
}
}

function isDSTEU(d){
	var m = d.getMonth();
	if(m>=10 || m<=1)
		return false;
	if(m>=3 && m<=8)
		return true;
	if(m==2)
		if(d.getDate() - d.getDay() + 7 > 31)
			return true;
		else
			return false;
	if(m==9)
		if(d.getDate() - d.getDay() + 7 > 31)
			return false;
		else
			return true;		
}

function isDSTUS(d){
	var m = d.getMonth();
	if(m>=11 || m<=1)
		return false;
	if(m>=3 && m<=9)
		return true;
	if(m==2)
		if(d.getDate() - d.getDay() > 7)
			return true;
		else
			return false;
	if(m==10)
		if(d.getDate() - d.getDay() > 0)
			return false;
		else
			return true;		
}

function rotateTzs(){
var cs = document.querySelectorAll(".tz");
var dt = new Date();
//dt.setMonth(10)
//dt.setDate(3)
var ofs = dt.getTimezoneOffset();
//alert(ofs);
for(var i =0; i < cs.length; i++) {
var j = i;
if(i>=12) {
	j = 21 - i;
	if(i>=15) {
		j-=4;
		if(isDSTUS(dt))
			j++;
	}else if(isDSTEU(dt))
		j++;
}
var deg = j*360/12 + (300+ofs)*360/(12*60);
rotateMe(cs[i], deg);
}
}


function setStrelki(){
var dt = new Date();
var secs = dt.getSeconds() + (60 * dt.getMinutes()) + (60 * 60 * dt.getHours());
if(window.location.search.includes("demo"))
	secs = 32+10*60+10*60*60;
rotateMe(document.querySelector("#ch"), secs*360/(60*60*12));
rotateMe(document.querySelector("#tzs"), secs*360/(60*60*12));
rotateMe(document.querySelector("#mi"), secs*360/(60*60));
rotateMe(document.querySelector("#se"), secs*360/(60));
}

function createTicks(){
 var ri = document.getElementById("ri");
 for(var i = 1; i < 60; i++) {
 var nri = ri.cloneNode(true);
 rotateMe(nri, i*360/(60));
 if(i%5 != 0)
	nri.setAttribute("height",0.2);
 ri.parentNode.insertBefore(nri, ri.nextSibling);
 }
}

function rotateMe(el, deg){
	var attrValue = "rotate("+deg+", 24, 24)";
    el.setAttribute('transform', attrValue);
}
</script>