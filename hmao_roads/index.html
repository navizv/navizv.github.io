<html><meta http-equiv="Content-type: text/html; charset=UTF-8">
<!--meta property="og:image" content="https://navizv.github.io/preg19/img.png" />
<meta property="og:image:width" content="120" />
<meta property="og:image:height" content="100" />
<meta property="og:title" content="Социально-экономические показатели регионов Российской Федерации">
<meta property="og:description" content="Социально-экономические показатели регионов Российской Федерации" />
<meta property="og:url" content="https://navizv.github.io/preg19/" /-->
<meta property="og:locale" content="ru_RU" />
    <head>
        <title>
            Дороги ХМАО-Югры
        </title>

        <script src="../libs/js/jquery.min.js"></script>
        <script src="../libs/js/jquery-ui-1.10.3.custom.min.js"></script>
        <script src="../libs/js/jquery.ui.touch-punch.min.js"></script>
        
        <style>
        </style>
    </head>
    <body>
	<object id="map" width="784" data="map.svg" onLoad="doit()"></object>
	<br/>Информация для тестирования, может не соответствовать действительности!
	<div id="updinfo"></div>
<hr/>

Источник карты: <a href="https://ru.wikipedia.org/wiki/%D0%A4%D0%B0%D0%B9%D0%BB:Blank_map_of_xmao-geoloc.svg" target="_blank">Википедия</a><br/>
Copyright (c) 2019 <a href="http://fb.com/Navizv">Зайцев И.Д.</a><br/>

<script>
function doit(){
	var curDate = new Date();
	$("#updinfo").html("Дата обновления: " + $.datepicker.formatDate('dd.mm.yy', curDate));
	
	var tooltip = $('<div id="tooltip" style="position:absolute;opacity:0.8;border:solid;border-color:black;border-width:2;padding:3 3 3 3;display:none;background-color:white;color:black;"></div>')
                    .appendTo(document.body);
	var svgd = document.getElementById('map').contentDocument;
	//$(svgd.getElementById("pri_and")).css({stroke:"green"});
	var isie = (/msie|trident/i).test(navigator.userAgent);//$.browser.msie;
	var show_tooltip = function(tit, evt) {
		tooltip.html(tit);
		tooltip.css({
			left: evt.pageX + 10,
			top: evt.pageY + 10,
			display: "inline"
		});
	}

    var hide_tooltip = function() {
		tooltip.css({display: "none"});
    }
    if (isie)
		$("body").mousedown(hide_tooltip);	
	
	var tab = [];
	$.ajax({//заполняем список регионов
        type: "GET",
        url: "roads.csv",
        dataType: "text",
        success: function(sod) {
			var lines = sod.split(/\r\n|\n/);
			for(var i in lines){
				var mas = lines[i].split(';');
				if(i == 0){
					$("#updinfo").html("Дата обновления: " + mas[3]);//$.datepicker.formatDate('dd.mm.yy', curDate));
					continue;//skip first
				}
				if(mas.length < 3)
					continue;
				tab[mas[0]] = mas;
				var dt = mas[2].split('.');
				var d = new Date(dt[2],dt[1]-1,dt[0]);
				if(d < curDate)
					$(svgd.getElementById(mas[0])).css({stroke:"green"});
                $(svgd.getElementById(mas[0])).mousedown(function(evt) {
					var t = tab[this.id][1] + "<br/> Ожидаемая дата открытия: " + tab[this.id][2];
                    show_tooltip(t, evt);
                }).hover(function(evt) {
					var t = tab[this.id][1] + "<br/> Ожидаемая дата открытия: " + tab[this.id][2];
                    show_tooltip(t, evt);
                }).mouseout(function() {
                    if (isie) {
                    } else {
                        hide_tooltip();
                    }
                });
			}
		}
	});
}	
	</script>
</body>
</html>
