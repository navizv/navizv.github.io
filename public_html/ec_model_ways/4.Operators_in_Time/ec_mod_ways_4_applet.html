<html>
<head>
<title>ec_mod_ways_4_applet</title>
<style type="text/css">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<!--
  :link { color: rgb(110, 0, 110); } 
  :visited { color: rgb(110, 0, 110); } 
  body { margin-left: 5px; font-family: arial, sans-serif; 
         background: white; font-size: 12pt } 
  h2 { background: rgb(166,172,255); 
       font-size: 15pt; 
       padding-left: 6px; padding-right: 6px; padding-top: 6px; 
       padding-bottom: 6px; } 
  p { margin-left: 10px; } 
  pre { margin-left: 13px; background: rgb(225,225,225); 
        font-family: monospace; padding-left: 3px; padding-right: 3px; 
        padding-top: 3px; padding-bottom: 3px; } 
-->
</style>
</head>
<body>

<!--<p>This page was automatically generated by NetLogo 4.1.
Questions, problems?  Contact <a href="mailto:feedback@ccl.northwestern.edu">feedback@ccl.northwestern.edu</a>.</p>
-->
<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://java.sun.com/getjava/download.html">Sun's Java site</a>.</p>
<!--
<p><hr>

<p><font size="-1">In order for this to work, this file, your model file
(ec_mod_ways_4_applet.nlogo), and the file NetLogoLite.jar
must all be in the same directory.  (You can copy NetLogoLite.jar
from the directory where you installed NetLogo.)</font></p>

<p><font size="-1">On some systems, you can test the applet locally on your computer
before uploading it to a web server.  It doesn't work on all systems,
though, so if it doesn't work from your hard drive, please try
uploading it to a web server.</font></p>

<p><font size="-1">You don't need to include everything in this file in your page.
If you want, you can just take the HTML code beginning with
&lt;applet&gt; and ending with &lt;/applet&gt;, and paste it into any HTML
file you want.  It's even OK to put multiple &lt;applet&gt; tags
on a single page.</font></p>

<p><font size="-1">If NetLogoLite.jar and your model are in different
directories, you must modify the archive= and value= lines
in the HTML code to point to their actual locations.
(For example, if you have multiple applets in different
directories on the same web server, you may want to put 
a single copy of NetLogoLite.jar in one central place and
change the archive= lines of all the HTML files to point
to that one central copy.  This will save disk space for
you and download time for your users.)</font></p>
-->
<p>
<applet code="org.nlogo.lite.Applet"
        archive="../../NetLogoLite.jar"
        width="1241" height="668">
  <param name="DefaultModel"
         value="ec_mod_ways_4_applet.nlogo">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="ec_mod_ways_4_applet.nlogo">ec_mod_ways_4_applet.nlogo</a>
</p>
<h2>WHAT IS IT?</h2>
<p>Модель развития транспортной сети, предназначенной для перевозки планируемого объёма единиц условного груза между странами и обслуживаемой несколькими операторами.</p><br>
<h2>HOW IT WORKS</h2>
<p>Управление такое - при нажатии определённой клавиши на клавиатуре что-то происходит с тем местом, где сейчас находится мышь. Для того, чтоб всё это работало, надо, чтобы буква Т на кнопке &quot;Тест&quot; слева от карты была чёрной. Для этого надо просто щёлкнуть мышью куда-нибудь в ту белую область, не на кнопку. </p>
<p>Действия при нажатии буквы (перечислены на главном окне моделирования):</p>
<p>С - страна - под указателем мыши создаётся страна;<br>У - узел - узел, &quot;перевалочный пункт&quot;;<br>Д - дорога - путь, т.е. физическая связь между страной и узлом или двумя узлами (потом надо дотянуть его мышкой до какого-то объекта и щёлкнуть левой клавишей мыши, если же не надо его рисовать, то просто отвести в сторону, и щёлкнуть левой клавишей мыши);<br>П - поток - планируемый грузопоток (это стрелка от страны к стране, символизирует нефизическую связь между странами - кто кому сколько планирует поставлять условных единиц груза, создаётся так же, как и дорога);<br>К - компания - компания-оператор, обслуживающая несколько дорог. Также эту кнопку надо нажимать вблизи значка компании, чтобы задать её номер;<br>М - международная организация;<br>В - вхождение - связь между страной и оператором, или страной и международной; организацией, или оператором и международной организацией. Рисуется так же, как и дорога.</p>
<p>Ц - цена - для ближайших к указателю мыши дороге или потоку установить цену;<br>О - объём - для ближайших к указателю мыши дороге или потоку установить объём;<br>Б - будущий объём - для ближайшего к указателю мыши потоку установить планируемый будущий объём через 10 лет;<br>Н - название - для ближайшей к указателю мыши страны, международной организации или компании-оператора установить название;<br>х - удалить - удалить ближайший к указателю мыши объект (вершину или связь).</p>
<p>Если нажата кнопка &quot;Режим перемещения&quot;, то вдобавок ко всему можно при нажатой левой клавише мыши перетаскивать объекты (страны и узлы).</p>
<p>Кнопки режима устанавливают, какие объекты выводить на экран, а какие скрывать.</p><br>
<h2>HOW TO USE IT</h2>
<p>Для начала нужно создать или загрузить мир - схему всех объектов и связей. При создании для каждой дороги устанавливается объём (пропускная способность), цена (себестоимость перевозки единицы груза), номер компании-оператора, обслуживающей дорогу. <br>Для каждого потока устанавливается объём (величина грузопотока), будущий объём (планируемая величина грузопотока через 10 лет), цена (приоритет при рассмотрении).<br>Для каждого оператора устанавливается номер и название.</p>
<p>Можно устанавливать названия для стран, международные сообщества и связи.</p>
<p>Затем, по кнопке &quot;Вычислить&quot; ищется наиболее выгодный путь для каждого потока согласно его приоритету. По кнопке Пуск запускается моделирование на 10 условных лет (такт = квартал). На графике при этом рисуется значение денежного запаса для каждого оператора.<br>По кнопке &quot;Сброс&quot; моделирование сбрасывается на нулевой год, все изменения параметров объектов забываются.</p>
<p>Все динамически изменяемые параметры модели выведены на бегунки снизу от карты. По кнопке &quot;Сброс параметров&quot; все параметры сбрасываются, все изменения параметров модели забываются.</p><br>
<h2>THINGS TO NOTICE</h2>
<p>This section could give some ideas of things for the user to notice while running the model.</p><br>
<h2>THINGS TO TRY</h2>
<p>This section could give some ideas of things for the user to try to do (move sliders, switches, etc.) with the model.</p><br>
<h2>EXTENDING THE MODEL</h2>
<p>This section could give some ideas of things to add or change in the procedures tab to make the model more complicated, detailed, accurate, etc.</p><br>
<h2>NETLOGO FEATURES</h2>
<p>This section could point out any especially interesting or unusual features of NetLogo that the model makes use of, particularly in the Procedures tab.  It might also point out places where workarounds were needed because of missing features.</p><br>
<h2>RELATED MODELS</h2>
<p>This section could give the names of models in the NetLogo Models Library or elsewhere which are of related interest.</p><br>
<h2>CREDITS AND REFERENCES</h2>
<p>This section could contain a reference to the model's URL on the web if it has one, as well as any other necessary credits or references.</p><br>
<h2>PROCEDURES</h2>
<pre><font color="#007f69">breed</font><font color="#000000"> [countries country]
</font><font color="#660096">breed</font><font color="#000000"> [nodes node]
</font><font color="#660096">breed</font><font color="#000000"> [opers oper]
</font><font color="#660096">breed</font><font color="#000000"> [mcs mc]

</font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [ways way]
</font><font color="#007f69">directed-link-breed</font><font color="#000000"> [streams stream]
</font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [members member]

</font><font color="#007f69">countries-own</font><font color="#000000"> [in-use? min-len min-neib tmpvolume name c-num p-o-t]
</font><font color="#007f69">nodes-own</font><font color="#000000"> [in-use? min-len min-neib tmpvolume name c-num p-o-t]
</font><font color="#007f69">opers-own</font><font color="#000000"> [num name stock]
</font><font color="#007f69">mcs-own</font><font color="#000000"> [name]

</font><font color="#007f69">ways-own</font><font color="#000000"> [price initprice volume initvolume curvolume avgcurvolume company]
</font><font color="#007f69">streams-own</font><font color="#000000"> [price initprice volume initvolume curvolume prognoz tendency]

</font><font color="#007f69">globals</font><font color="#000000"> [nt filename years
  </font><font color="#5a5a5a">;chvolume-zagr </font><font color="#000000">
  </font><font color="#5a5a5a">;chvolume-delta</font><font color="#000000">
  ]

</font><font color="#007f69">to</font><font color="#000000"> save-as
  </font><font color="#0000aa">let</font><font color="#000000"> tmp </font><font color="#660096">user-new-file</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> tmp </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> tmp </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> filename tmp
    </font><font color="#0000aa">export-world</font><font color="#000000"> filename
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> save
  </font><font color="#0000aa">ifelse</font><font color="#000000"> filename </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> filename </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> filename </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [
    save-as
  ][
    </font><font color="#0000aa">export-world</font><font color="#000000"> filename
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> open
  </font><font color="#5a5a5a">;user-message &quot;qq&quot;</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> tmp </font><font color="#660096">user-file</font><font color="#000000">
  </font><font color="#5a5a5a">;user-message tmp</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> tmp </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> tmp </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [
    </font><font color="#0000aa">import-world</font><font color="#000000"> tmp</font><font color="#5a5a5a">;&quot;default.csv&quot;;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> filename tmp
  ]
  reset-modeling
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> set-background
  </font><font color="#0000aa">let</font><font color="#000000"> tmp-uf </font><font color="#660096">user-file</font><font color="#5a5a5a">;&quot;ris.png&quot;;</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> tmp-uf </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [
    </font><font color="#0000aa">clear-drawing</font><font color="#000000">
    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000">]
    </font><font color="#0000aa">import-drawing</font><font color="#000000"> tmp-uf
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-mode
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">mouse-down?</font><font color="#000000"> [
    </font><font color="#0000aa">let</font><font color="#000000"> a-country </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
    </font><font color="#0000aa">if</font><font color="#000000"> a-country </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
      </font><font color="#0000aa">ask</font><font color="#000000"> a-country [
        </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">mouse-down?</font><font color="#000000">] [
          </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
          </font><font color="#0000aa">display</font><font color="#000000">
        ]
      ]  
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-country
  </font><font color="#5a5a5a">;if mode != 1 [stop]</font><font color="#000000">
  create-countries </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;house&quot;</font><font color="#000000">
    </font><font color="#5a5a5a">;set label who</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
    </font><font color="#0000aa">display</font><font color="#000000">
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-mc
  </font><font color="#5a5a5a">;if mode != 1 [stop]</font><font color="#000000">
  create-mcs </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;flag&quot;</font><font color="#000000">
    </font><font color="#5a5a5a">;set label who</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
    </font><font color="#0000aa">display</font><font color="#000000">
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-node
  </font><font color="#5a5a5a">;if mode != 1 [stop]</font><font color="#000000">
  create-nodes </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000">
    </font><font color="#5a5a5a">;set label who</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
    </font><font color="#0000aa">display</font><font color="#000000">
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-oper
  </font><font color="#5a5a5a">;if mode != 1 [stop]</font><font color="#000000">
  create-opers </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;truck&quot;</font><font color="#000000">
    </font><font color="#5a5a5a">;set label who</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
    </font><font color="#0000aa">display</font><font color="#000000">
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-way
  </font><font color="#5a5a5a">;if mouse-down? [</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">create-turtles</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;dot&quot;</font><font color="#000000">
          </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
          create-way-with ver [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]
          </font><font color="#0000aa">let</font><font color="#000000"> dist </font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
          </font><font color="#0000aa">let</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
          </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">mouse-down?</font><font color="#000000">] [
            </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
            </font><font color="#0000aa">let</font><font color="#000000"> ver2 </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
            </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000">((is-country? ver </font><font color="#660096">and</font><font color="#000000"> is-node? ver2) </font><font color="#660096">or</font><font color="#000000"> (is-country? ver2 </font><font color="#660096">and</font><font color="#000000"> is-node? ver) </font><font color="#660096">or</font><font color="#000000"> (is-node? ver </font><font color="#660096">and</font><font color="#000000"> is-node? ver))
            [</font><font color="#0000aa">set</font><font color="#000000"> ver2 </font><font color="#963700">nobody</font><font color="#000000">]
            </font><font color="#0000aa">ifelse</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
              </font><font color="#0000aa">if</font><font color="#000000"> verx </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> verx[
                </font><font color="#0000aa">ask</font><font color="#000000"> verx[
                 </font><font color="#0000aa">ask</font><font color="#000000"> way-with ver [
                    </font><font color="#0000aa">die</font><font color="#000000">
                  ]]
                  </font><font color="#0000aa">set</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
              ]
              
              </font><font color="#0000aa">if</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> ver </font><font color="#660096">and</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> verx[
                </font><font color="#0000aa">ask</font><font color="#000000"> ver2 [
                  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> way-neighbor? ver[
                    create-way-with ver [
                      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> company)
                      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
                      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">
                    ]
                    </font><font color="#0000aa">set</font><font color="#000000"> verx ver2
                  ]
                ]
              ]
              
            ][
              </font><font color="#0000aa">if</font><font color="#000000"> verx </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
                </font><font color="#0000aa">ask</font><font color="#000000"> verx[
                 </font><font color="#0000aa">ask</font><font color="#000000"> way-with ver [
                    </font><font color="#0000aa">die</font><font color="#000000">
                  ]]
                  </font><font color="#0000aa">set</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
              ]
            ]
          ]
          </font><font color="#0000aa">die</font><font color="#000000">
        ]  
      ]
    </font><font color="#5a5a5a">;]</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-member
  </font><font color="#5a5a5a">;if mouse-down? [</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> nodes] </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">create-turtles</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;dot&quot;</font><font color="#000000">
          </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
          create-way-with ver [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">]
          </font><font color="#0000aa">let</font><font color="#000000"> dist </font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
          </font><font color="#0000aa">let</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
          </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">mouse-down?</font><font color="#000000">] [
            </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
            </font><font color="#0000aa">let</font><font color="#000000"> ver2 </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
            </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000">((is-country? ver </font><font color="#660096">and</font><font color="#000000"> (is-oper? ver2 </font><font color="#660096">or</font><font color="#000000"> is-mc? ver2)) </font><font color="#660096">or</font><font color="#000000"> (is-country? ver2 </font><font color="#660096">and</font><font color="#000000"> (is-oper? ver </font><font color="#660096">or</font><font color="#000000"> is-mc? ver)) </font><font color="#660096">or</font><font color="#000000"> (is-oper? ver </font><font color="#660096">and</font><font color="#000000"> is-mc? ver2) </font><font color="#660096">or</font><font color="#000000"> (is-oper? ver2 </font><font color="#660096">and</font><font color="#000000"> is-mc? ver))
            [</font><font color="#0000aa">set</font><font color="#000000"> ver2 </font><font color="#963700">nobody</font><font color="#000000">]
            </font><font color="#0000aa">ifelse</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
              </font><font color="#0000aa">if</font><font color="#000000"> verx </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> verx[
                </font><font color="#0000aa">ask</font><font color="#000000"> verx[
                 </font><font color="#0000aa">ask</font><font color="#000000"> way-with ver [
                    </font><font color="#0000aa">die</font><font color="#000000">
                  ]]
                  </font><font color="#0000aa">set</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
              ]
              
              </font><font color="#0000aa">if</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> ver </font><font color="#660096">and</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> verx[
                </font><font color="#0000aa">ask</font><font color="#000000"> ver2 [
                  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> way-neighbor? ver[
                    create-way-with ver [
                      </font><font color="#5a5a5a">;set label (word price &quot;; &quot; volume &quot;; &quot; company)</font><font color="#000000">
                      </font><font color="#5a5a5a">;set label-color black</font><font color="#000000">
                      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">
                    ]
                    </font><font color="#0000aa">set</font><font color="#000000"> verx ver2
                  ]
                ]
              ]
              
            ][
              </font><font color="#0000aa">if</font><font color="#000000"> verx </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
                </font><font color="#0000aa">ask</font><font color="#000000"> verx[
                 </font><font color="#0000aa">ask</font><font color="#000000"> way-with ver [
                    </font><font color="#0000aa">die</font><font color="#000000">
                  ]]
                  </font><font color="#0000aa">set</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
              ]
            ]
          ]
          </font><font color="#0000aa">die</font><font color="#000000">
        ]  
      ]
    </font><font color="#5a5a5a">;]</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#007f69">to-report</font><font color="#000000"> ldistancexy [x y]
  </font><font color="#0000aa">let</font><font color="#000000"> a2 </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> b2 </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> c2 </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> tmp </font><font color="#660096">end2</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> a2 </font><font color="#660096">distancexy</font><font color="#000000"> x y
    </font><font color="#0000aa">set</font><font color="#000000"> c2 </font><font color="#660096">distance</font><font color="#000000"> tmp
  ]
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">end2</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> b2 </font><font color="#660096">distancexy</font><font color="#000000"> x y]
  </font><font color="#0000aa">if</font><font color="#000000"> a2 </font><font color="#660096">&gt;</font><font color="#000000"> c2 </font><font color="#660096">or</font><font color="#000000"> b2 </font><font color="#660096">&gt;</font><font color="#000000"> c2 [</font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">min</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> a2 b2]
  </font><font color="#0000aa">set</font><font color="#000000"> a2 a2 </font><font color="#660096">*</font><font color="#000000"> a2
  </font><font color="#0000aa">set</font><font color="#000000"> b2 b2 </font><font color="#660096">*</font><font color="#000000"> b2  
  </font><font color="#0000aa">set</font><font color="#000000"> c2 c2 </font><font color="#660096">*</font><font color="#000000"> c2
  </font><font color="#0000aa">let</font><font color="#000000"> tmp2 c2 </font><font color="#660096">-</font><font color="#000000"> a2 </font><font color="#660096">-</font><font color="#000000"> b2
  </font><font color="#0000aa">let</font><font color="#000000"> h2 (</font><font color="#963700">4</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> a2 </font><font color="#660096">*</font><font color="#000000"> b2 </font><font color="#660096">-</font><font color="#000000"> tmp2 </font><font color="#660096">*</font><font color="#000000"> tmp2) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#963700">4</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> c2)
  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">sqrt</font><font color="#000000"> h2
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> delete-object
  </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
  </font><font color="#0000aa">ifelse</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
    </font><font color="#0000aa">ask</font><font color="#000000"> ver [
      </font><font color="#0000aa">ask</font><font color="#000000"> my-ways [
        </font><font color="#0000aa">die</font><font color="#000000">
      ]
      </font><font color="#0000aa">die</font><font color="#000000">
    ]
  ][
    </font><font color="#0000aa">set</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> ways </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
      </font><font color="#0000aa">ask</font><font color="#000000"> ver [</font><font color="#0000aa">die</font><font color="#000000">]
    ][
      </font><font color="#0000aa">set</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> streams </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">ask</font><font color="#000000"> ver [</font><font color="#0000aa">die</font><font color="#000000">]
        </font><font color="#5a5a5a">;!!!!</font><font color="#000000">
      ]
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> str-cv [str var]
  </font><font color="#0000aa">ifelse</font><font color="#000000"> var </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> var </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [
    </font><font color="#0000aa">report</font><font color="#000000"> str
  ][
    </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> str </font><font color="#963700">&quot;\n(Текущее значение - \&quot;&quot;</font><font color="#000000"> var </font><font color="#963700">&quot;\&quot;)&quot;</font><font color="#000000">)
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> link-id [str]
  </font><font color="#0000aa">let</font><font color="#000000"> tmp1 [name] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> tmp2 [name] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">end2</font><font color="#000000">

  </font><font color="#0000aa">let</font><font color="#000000"> res </font><font color="#963700">&quot;(&quot;</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> tmp1 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> tmp1 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> res (</font><font color="#660096">word</font><font color="#000000"> res </font><font color="#963700">&quot;от \&quot;&quot;</font><font color="#000000"> tmp1 </font><font color="#963700">&quot;\&quot;&quot;</font><font color="#000000">)
  ]
  </font><font color="#0000aa">if</font><font color="#000000"> tmp2 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> tmp2 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">last</font><font color="#000000"> res </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;(&quot;</font><font color="#000000"> [
      </font><font color="#0000aa">set</font><font color="#000000"> res (</font><font color="#660096">word</font><font color="#000000"> res </font><font color="#963700">&quot; &quot;</font><font color="#000000">)
    ]
    </font><font color="#0000aa">set</font><font color="#000000"> res (</font><font color="#660096">word</font><font color="#000000"> res </font><font color="#963700">&quot;к \&quot;&quot;</font><font color="#000000"> tmp2 </font><font color="#963700">&quot;\&quot;&quot;</font><font color="#000000">)
  ]
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">last</font><font color="#000000"> res </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;(&quot;</font><font color="#000000"> [
    </font><font color="#0000aa">report</font><font color="#000000"> str
  ]
  </font><font color="#0000aa">set</font><font color="#000000"> res (</font><font color="#660096">word</font><font color="#000000"> res </font><font color="#963700">&quot;)&quot;</font><font color="#000000">)  
  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">word</font><font color="#000000"> str res
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> edit-properties
  </font><font color="#5a5a5a">;let ver min-one-of turtles with [distancexy mouse-xcor mouse-ycor &lt; 1] [distancexy mouse-xcor mouse-ycor]</font><font color="#000000">
  </font><font color="#5a5a5a">;ifelse ver != nobody [][</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> ways </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
      </font><font color="#0000aa">ask</font><font color="#000000"> ver [
        </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> str-cv link-id </font><font color="#963700">&quot;Введите цену для данной дороги&quot;</font><font color="#000000"> price
        </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">
        [
          </font><font color="#0000aa">set</font><font color="#000000"> price </font><font color="#660096">read-from-string</font><font color="#000000"> tmps
          </font><font color="#0000aa">set</font><font color="#000000"> initprice price
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> company)
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
        ]
      ]
    ][
      </font><font color="#0000aa">set</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> streams </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">ask</font><font color="#000000"> ver [
          </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> str-cv link-id </font><font color="#963700">&quot;Введите цену для данного потока&quot;</font><font color="#000000"> price
          </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">
          [
            </font><font color="#0000aa">set</font><font color="#000000"> price </font><font color="#660096">read-from-string</font><font color="#000000"> tmps
            </font><font color="#0000aa">set</font><font color="#000000"> initprice price
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> prognoz)
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
          ]
        ]
      ]
    ]
  </font><font color="#5a5a5a">;]</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> edit-properties-v
  </font><font color="#5a5a5a">;let ver min-one-of turtles with [distancexy mouse-xcor mouse-ycor &lt; 1] [distancexy mouse-xcor mouse-ycor]</font><font color="#000000">
  </font><font color="#5a5a5a">;ifelse ver != nobody [][</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> ways </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
      </font><font color="#0000aa">ask</font><font color="#000000"> ver [
        </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> str-cv link-id </font><font color="#963700">&quot;Введите объём для данной дороги&quot;</font><font color="#000000"> volume
        </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">
        [
          </font><font color="#0000aa">set</font><font color="#000000"> volume </font><font color="#660096">read-from-string</font><font color="#000000"> tmps
          </font><font color="#0000aa">set</font><font color="#000000"> initvolume volume
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> company)
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
        ]
      ]
    ][
      </font><font color="#0000aa">set</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> streams </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">ask</font><font color="#000000"> ver [
          </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> str-cv link-id </font><font color="#963700">&quot;Введите объём для данного потока&quot;</font><font color="#000000"> volume
          </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">
          [
            </font><font color="#0000aa">set</font><font color="#000000"> volume </font><font color="#660096">read-from-string</font><font color="#000000"> tmps
            </font><font color="#0000aa">set</font><font color="#000000"> initvolume volume
            </font><font color="#0000aa">if</font><font color="#000000"> prognoz </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> prognoz </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [
              calculate-prognoz
            ]
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> prognoz)
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
          ]
        ]
      ]
    ]
  </font><font color="#5a5a5a">;]</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> calculate-prognoz
  </font><font color="#0000aa">if</font><font color="#000000"> tendency </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> tendency </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> tendency </font><font color="#963700">1</font><font color="#000000">
  ]
  </font><font color="#0000aa">set</font><font color="#000000"> prognoz volume </font><font color="#660096">+</font><font color="#000000"> tendency </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> prognoz </font><font color="#660096">precision</font><font color="#000000"> prognoz </font><font color="#963700">2</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> prognoz)
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> edit-future-volume
  </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> streams </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">ask</font><font color="#000000"> ver [
          </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> str-cv link-id </font><font color="#963700">&quot;Введите прогноз объёма для данного потока&quot;</font><font color="#000000"> prognoz
          </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">
          [
            </font><font color="#0000aa">set</font><font color="#000000"> prognoz </font><font color="#660096">read-from-string</font><font color="#000000"> tmps
            </font><font color="#0000aa">set</font><font color="#000000"> tendency (prognoz </font><font color="#660096">-</font><font color="#000000"> volume) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> prognoz)
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
          ]
        ]
      ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> edit-company
  </font><font color="#5a5a5a">;let ver min-one-of turtles with [distancexy mouse-xcor mouse-ycor &lt; 1] [distancexy mouse-xcor mouse-ycor]</font><font color="#000000">
  </font><font color="#5a5a5a">;ifelse ver != nobody [][</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> ways </font><font color="#660096">with</font><font color="#000000"> [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [ldistancexy </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
      </font><font color="#0000aa">ask</font><font color="#000000"> ver [
        </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> str-cv link-id </font><font color="#963700">&quot;Введите номер компании для данной дороги&quot;</font><font color="#000000"> company
        </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">
        [
          </font><font color="#0000aa">set</font><font color="#000000"> company </font><font color="#660096">read-from-string</font><font color="#000000"> tmps
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> company)
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
        ]
      ]
    ][
      </font><font color="#0000aa">set</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> opers </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">ifelse</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">ask</font><font color="#000000"> ver [
          </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> str-cv </font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Введите номер для оператора &quot;</font><font color="#000000"> name num
          </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">
          [
            </font><font color="#0000aa">let</font><font color="#000000"> num-tmp </font><font color="#660096">read-from-string</font><font color="#000000"> tmps
            </font><font color="#0000aa">let</font><font color="#000000"> op-tmp </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> opers </font><font color="#660096">with</font><font color="#000000"> [num </font><font color="#660096">=</font><font color="#000000"> num-tmp]
            </font><font color="#0000aa">if</font><font color="#000000"> op-tmp </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">[
              </font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;Опреатор с таким номером уже существует!&quot;</font><font color="#000000">
              </font><font color="#0000aa">stop</font><font color="#000000">
            ]
            </font><font color="#0000aa">set</font><font color="#000000"> num num-tmp
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> num </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> name </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> stock)
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
          ]
        ]
      ][
        setup-oper
      ]
    ]
  </font><font color="#5a5a5a">;]</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> edit-name
  </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
    </font><font color="#0000aa">ask</font><font color="#000000"> ver [
      </font><font color="#0000aa">let</font><font color="#000000"> tmps </font><font color="#963700">&quot;&quot;</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> countries [
        </font><font color="#0000aa">ifelse</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> [
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#963700">&quot;Введите название для данной страны&quot;</font><font color="#000000">
        ][
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Введите новое название для страны &quot;</font><font color="#000000"> name
        ]
      ]
      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> nodes [
        </font><font color="#0000aa">ifelse</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> [
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#963700">&quot;Введите название для данного узла&quot;</font><font color="#000000">
        ][
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Введите новое название для узла &quot;</font><font color="#000000"> name
        ]
      ]
      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> opers [
        </font><font color="#0000aa">ifelse</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> [
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#963700">&quot;Введите название для данного оператора&quot;</font><font color="#000000">
        ][
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Введите новое название для оператора &quot;</font><font color="#000000"> name
        ]
      ]
      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> mcs [
        </font><font color="#0000aa">ifelse</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> name </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> [
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#963700">&quot;Введите название для данной международной организации&quot;</font><font color="#000000">
        ][
          </font><font color="#0000aa">set</font><font color="#000000"> tmps </font><font color="#660096">user-input</font><font color="#000000"> </font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Введите новое название для международной организации &quot;</font><font color="#000000"> name
        ]
      ]
      
      
      </font><font color="#0000aa">if</font><font color="#000000"> tmps </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000"> [
        </font><font color="#0000aa">set</font><font color="#000000"> name tmps
      ]

      </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> opers [
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> num </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> name </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> stock)
      ][
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> name      
      ]
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-stream
  </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">min-one-of</font><font color="#000000"> countries </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
      </font><font color="#0000aa">if</font><font color="#000000"> ver </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
        </font><font color="#0000aa">create-turtles</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;dot&quot;</font><font color="#000000">
          </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
          create-stream-from ver [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">]
          </font><font color="#0000aa">let</font><font color="#000000"> dist </font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
          </font><font color="#0000aa">let</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
          </font><font color="#0000aa">while</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">mouse-down?</font><font color="#000000">] [
            </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">
            </font><font color="#0000aa">let</font><font color="#000000"> ver2 </font><font color="#660096">min-one-of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> countries </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#660096">mouse-xcor</font><font color="#000000"> </font><font color="#660096">mouse-ycor</font><font color="#000000">]
            </font><font color="#0000aa">ifelse</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
              </font><font color="#0000aa">if</font><font color="#000000"> verx </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> verx[
                </font><font color="#0000aa">ask</font><font color="#000000"> verx[
                 </font><font color="#0000aa">ask</font><font color="#000000"> in-stream-from ver [
                    </font><font color="#0000aa">die</font><font color="#000000">
                  ]]
                  </font><font color="#0000aa">set</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
              ]
              
              </font><font color="#0000aa">if</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> ver </font><font color="#660096">and</font><font color="#000000"> ver2 </font><font color="#660096">!=</font><font color="#000000"> verx[
                </font><font color="#0000aa">ask</font><font color="#000000"> ver2 [
                  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> in-stream-neighbor? ver[
                    create-stream-from ver [
                      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> prognoz)
                      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
                      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">
                    ]
                    </font><font color="#0000aa">set</font><font color="#000000"> verx ver2
                  ]
                ]
              ]
              
            ][
              </font><font color="#0000aa">if</font><font color="#000000"> verx </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
                </font><font color="#0000aa">ask</font><font color="#000000"> verx[
                 </font><font color="#0000aa">ask</font><font color="#000000"> in-stream-from ver [
                    </font><font color="#0000aa">die</font><font color="#000000">
                  ]]
                  </font><font color="#0000aa">set</font><font color="#000000"> verx </font><font color="#963700">nobody</font><font color="#000000">
              ]
            ]
          ]
          </font><font color="#0000aa">die</font><font color="#000000">
        ]  
      ]
</font><font color="#007f69">end</font><font color="#000000">
</font><font color="#5a5a5a">;---------------------------------------------FIND WAY------------------------------</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> calculate-streams
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> nodes </font><font color="#660096">or</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> countries] [
    </font><font color="#0000aa">set</font><font color="#000000"> in-use? </font><font color="#963700">false</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> min-len </font><font color="#963700">1000000</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
  ]
  </font><font color="#0000aa">let</font><font color="#000000"> tmp </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> nodes </font><font color="#660096">or</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> countries] </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> in-use?]
  </font><font color="#0000aa">ask</font><font color="#000000"> ways [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume)
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> curvolume volume
  ]
  </font><font color="#0000aa">let</font><font color="#000000"> tmplist </font><font color="#660096">sort-by</font><font color="#000000"> [[price] </font><font color="#660096">of</font><font color="#000000"> ?1 </font><font color="#660096">&gt;</font><font color="#000000"> [price] </font><font color="#660096">of</font><font color="#000000"> ?2] streams
  </font><font color="#0000aa">foreach</font><font color="#000000"> tmplist [
  </font><font color="#0000aa">ask</font><font color="#000000"> ? [
    </font><font color="#0000aa">set</font><font color="#000000"> curvolume volume
    </font><font color="#0000aa">while</font><font color="#000000"> [curvolume </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">][
      </font><font color="#0000aa">ask</font><font color="#000000"> tmp [
        </font><font color="#0000aa">set</font><font color="#000000"> in-use? </font><font color="#963700">false</font><font color="#000000">
        </font><font color="#0000aa">set</font><font color="#000000"> min-len </font><font color="#963700">1000000</font><font color="#000000">
        </font><font color="#0000aa">set</font><font color="#000000"> min-neib </font><font color="#963700">0</font><font color="#000000">
      ]
      </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">end2</font><font color="#000000">
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000"> [find-min-way-to ver]
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000"> [commit-way ver]
      </font><font color="#0000aa">ifelse</font><font color="#000000"> [min-len </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1000000</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000"> [ 
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">
        </font><font color="#0000aa">set</font><font color="#000000"> curvolume </font><font color="#963700">0</font><font color="#000000">][</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
      </font><font color="#0000aa">let</font><font color="#000000"> minus </font><font color="#660096">min</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> [tmpvolume] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000"> curvolume
      </font><font color="#0000aa">set</font><font color="#000000"> curvolume curvolume </font><font color="#660096">-</font><font color="#000000"> minus
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000"> [place-stream ver minus]
      ]
    ]
  ]]
  draw-ways
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> draw-ways
  </font><font color="#0000aa">let</font><font color="#000000"> maxvol [volume] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">max-one-of</font><font color="#000000"> ways [volume]
  </font><font color="#0000aa">ask</font><font color="#000000"> ways [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> </font><font color="#660096">precision</font><font color="#000000"> curvolume </font><font color="#963700">2</font><font color="#000000"> </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> company)
    </font><font color="#0000aa">ifelse</font><font color="#000000"> volume </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> curvolume </font><font color="#660096">=</font><font color="#000000"> volume [
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
    ][
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> ( volume </font><font color="#660096">-</font><font color="#000000"> curvolume ) </font><font color="#660096">/</font><font color="#000000"> maxvol
    ]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> curvolume </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000">
    ][
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> commit-way [dest]
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> dest [
    </font><font color="#0000aa">set</font><font color="#000000"> tmpvolume </font><font color="#963700">1000000</font><font color="#000000">
    </font><font color="#0000aa">stop</font><font color="#000000">
  ]
  </font><font color="#0000aa">if</font><font color="#000000"> min-neib </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
    </font><font color="#0000aa">ask</font><font color="#000000"> way-with min-neib [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">]
    </font><font color="#0000aa">ask</font><font color="#000000"> min-neib [commit-way dest]
    </font><font color="#0000aa">set</font><font color="#000000"> tmpvolume </font><font color="#660096">min</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> [tmpvolume] </font><font color="#660096">of</font><font color="#000000"> min-neib [curvolume] </font><font color="#660096">of</font><font color="#000000"> way-with min-neib
  ]
  </font><font color="#5a5a5a">;show tmpvolume</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> place-stream [dest minus]
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> dest [</font><font color="#0000aa">stop</font><font color="#000000">]
  </font><font color="#0000aa">ask</font><font color="#000000"> way-with min-neib [</font><font color="#0000aa">set</font><font color="#000000"> curvolume curvolume </font><font color="#660096">-</font><font color="#000000"> minus]
  </font><font color="#0000aa">ask</font><font color="#000000"> min-neib [place-stream dest minus]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> find-min-way-to [dest]
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> dest [
    </font><font color="#0000aa">set</font><font color="#000000"> min-len </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> min-neib </font><font color="#660096">self</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> c-num </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">stop</font><font color="#000000">
  ]
  
  </font><font color="#0000aa">set</font><font color="#000000"> in-use? </font><font color="#963700">true</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> ver </font><font color="#660096">self</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> possible way-neighbors </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> in-use? </font><font color="#660096">and</font><font color="#000000"> [curvolume </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> way-with ver]
  
  </font><font color="#0000aa">ask</font><font color="#000000"> possible [find-min-way-to dest]

  </font><font color="#0000aa">let</font><font color="#000000"> tmp-ver </font><font color="#660096">min-one-of</font><font color="#000000"> possible [price-of-to ver]

  </font><font color="#0000aa">if</font><font color="#000000"> tmp-ver </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> in-use? </font><font color="#963700">false</font><font color="#000000">
    </font><font color="#0000aa">stop</font><font color="#000000">
  ]
  
  </font><font color="#0000aa">let</font><font color="#000000"> tmp [p-o-t] </font><font color="#660096">of</font><font color="#000000"> tmp-ver
  </font><font color="#0000aa">if</font><font color="#000000"> tmp </font><font color="#660096">&lt;</font><font color="#000000"> min-len [
    </font><font color="#0000aa">set</font><font color="#000000"> min-len tmp
    </font><font color="#0000aa">set</font><font color="#000000"> min-neib tmp-ver
    
    </font><font color="#0000aa">set</font><font color="#000000"> c-num [company] </font><font color="#660096">of</font><font color="#000000"> way-with min-neib
  ]
  
  </font><font color="#0000aa">set</font><font color="#000000"> in-use? </font><font color="#963700">false</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> price-of-to [ver]
  </font><font color="#0000aa">let</font><font color="#000000"> tmp min-len
  </font><font color="#0000aa">let</font><font color="#000000"> curcompany c-num
  </font><font color="#0000aa">let</font><font color="#000000"> cm </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> c-num </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> min-neib </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [c-num] </font><font color="#660096">of</font><font color="#000000"> min-neib </font><font color="#660096">!=</font><font color="#000000"> c-num [
    </font><font color="#0000aa">set</font><font color="#000000"> cm [price] </font><font color="#660096">of</font><font color="#000000"> way-with min-neib
  ]
  </font><font color="#0000aa">ask</font><font color="#000000"> way-with ver [
    </font><font color="#0000aa">if</font><font color="#000000"> tmp </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">1000000</font><font color="#000000"> [
      </font><font color="#0000aa">ifelse</font><font color="#000000"> company </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> curcompany </font><font color="#660096">=</font><font color="#000000"> company [
        </font><font color="#0000aa">set</font><font color="#000000"> tmp tmp </font><font color="#660096">+</font><font color="#000000"> price </font><font color="#660096">*</font><font color="#000000"> ( </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> skidka ) </font><font color="#5a5a5a">; СКИДКА!</font><font color="#000000">
      ][
        </font><font color="#0000aa">set</font><font color="#000000"> tmp tmp </font><font color="#660096">+</font><font color="#000000"> price
      ]
    ]
  ]
  </font><font color="#0000aa">set</font><font color="#000000"> p-o-t tmp
  </font><font color="#0000aa">report</font><font color="#000000"> tmp
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> calculate-streams-avg
  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> ways [
    </font><font color="#0000aa">set</font><font color="#000000"> avgcurvolume </font><font color="#963700">0</font><font color="#000000">
  ]
  </font><font color="#0000aa">let</font><font color="#000000"> my-end </font><font color="#963700">50</font><font color="#000000">
  </font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;</font><font color="#000000"> my-end][
    calculate-streams
    </font><font color="#0000aa">ask</font><font color="#000000"> ways [
      </font><font color="#0000aa">set</font><font color="#000000"> avgcurvolume avgcurvolume </font><font color="#660096">+</font><font color="#000000"> curvolume
    ]
    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
  ]
  </font><font color="#0000aa">ask</font><font color="#000000"> ways [
    </font><font color="#0000aa">set</font><font color="#000000"> curvolume avgcurvolume </font><font color="#660096">/</font><font color="#000000"> my-end
  ]
  draw-ways
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;----------------------------------------------MODELING IN TIME-----------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> modeling
  calculate-streams
  </font><font color="#0000aa">ask</font><font color="#000000"> opers </font><font color="#660096">with</font><font color="#000000"> [num </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">][
    vyruchka
    chprice
    chvolume
    check-state
  ]
  chstreams
  do-plots
  </font><font color="#0000aa">tick</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
    </font><font color="#0000aa">set</font><font color="#000000"> years years </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> years </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
      </font><font color="#0000aa">ask</font><font color="#000000"> streams [
        </font><font color="#0000aa">let</font><font color="#000000"> tmp prognoz
        calculate-prognoz
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot; (&quot;</font><font color="#000000"> tmp </font><font color="#963700">&quot;); &quot;</font><font color="#000000"> prognoz)
      ]
      </font><font color="#0000aa">stop</font><font color="#000000">
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> reset-modeling
  </font><font color="#0000aa">clear-all-plots</font><font color="#000000">
  </font><font color="#5a5a5a">;import-world filename</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> streams </font><font color="#660096">or</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> ways][
    </font><font color="#0000aa">set</font><font color="#000000"> volume initvolume
    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> streams [
      calculate-prognoz
    ]
    </font><font color="#0000aa">set</font><font color="#000000"> price initprice 
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">thickness</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
    
    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> ways [
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> company)
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">
    ][
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> prognoz)
    ]
  ]
  </font><font color="#0000aa">ask</font><font color="#000000"> opers [</font><font color="#0000aa">set</font><font color="#000000"> stock </font><font color="#963700">100</font><font color="#000000">]
  
  </font><font color="#0000aa">reset-ticks</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> years </font><font color="#963700">0</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> reset-modeling-parameters
  </font><font color="#0000aa">set</font><font color="#000000"> chvolume-zagr </font><font color="#963700">0.8</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> chvolume-delta </font><font color="#963700">6</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> chprice-delta </font><font color="#963700">1</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> chprice-low </font><font color="#963700">0.2</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> vyruchka-otkl </font><font color="#963700">1</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> oper-potreb </font><font color="#963700">5</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> subsidy </font><font color="#963700">100</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> check-state
  </font><font color="#0000aa">set</font><font color="#000000"> stock stock </font><font color="#660096">-</font><font color="#000000"> oper-potreb
  </font><font color="#0000aa">if</font><font color="#000000"> stock </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
    
    </font><font color="#5a5a5a">;let old-num num</font><font color="#000000">
    </font><font color="#5a5a5a">;let old-way one-of ways with [company = old-num]</font><font color="#000000">
    </font><font color="#5a5a5a">;let way-price [price * volume] of old-way</font><font color="#000000">
    </font><font color="#5a5a5a">;let new-oper one-of other opers with [stock &gt; way-price]</font><font color="#000000">
    </font><font color="#5a5a5a">;if old-way != nobody and new-oper != nobody[</font><font color="#000000">
      </font><font color="#5a5a5a">;ask old-way [set company [num] of new-oper]</font><font color="#000000">
      </font><font color="#5a5a5a">;set stock stock + way-price</font><font color="#000000">
      </font><font color="#5a5a5a">;ask new-oper [set stock stock - way-price]</font><font color="#000000">
    </font><font color="#5a5a5a">;]</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> stock subsidy
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> chstreams
  </font><font color="#5a5a5a">;if ticks &lt; 10[stop]</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> streams [
    </font><font color="#0000aa">set</font><font color="#000000"> volume volume </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random-normal</font><font color="#000000"> tendency chstream-otkl </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#5a5a5a">;* (6 - random 11) / 4 ;/ 100 ;* 0.01 * volume</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> volume </font><font color="#660096">precision</font><font color="#000000"> volume </font><font color="#963700">2</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> volume </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
      </font><font color="#0000aa">set</font><font color="#000000"> volume </font><font color="#963700">0</font><font color="#000000">
    ]
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> price </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> volume </font><font color="#963700">&quot;; &quot;</font><font color="#000000"> prognoz)
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> chvolume </font><font color="#5a5a5a">;izmenenie ob&quot;yomov svoih putej</font><font color="#000000">
  </font><font color="#5a5a5a">;if ticks &lt; 10[stop]</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> num-tmp num
  </font><font color="#0000aa">let</font><font color="#000000"> tmp-stock stock
  
  </font><font color="#0000aa">ask</font><font color="#000000"> ways </font><font color="#660096">with</font><font color="#000000"> [company </font><font color="#660096">=</font><font color="#000000"> num-tmp] [
    </font><font color="#0000aa">let</font><font color="#000000"> curvol-rel </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> volume </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
      </font><font color="#0000aa">set</font><font color="#000000"> curvol-rel </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> curvolume </font><font color="#660096">/</font><font color="#000000"> volume </font><font color="#5a5a5a">; Zagruzhennost'</font><font color="#000000">
    ]
    </font><font color="#0000aa">if</font><font color="#000000"> tmp-stock </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> curvol-rel </font><font color="#660096">&gt;</font><font color="#000000"> chvolume-zagr [
      </font><font color="#0000aa">let</font><font color="#000000"> tmp-delta chvolume-delta </font><font color="#660096">*</font><font color="#000000"> initprice</font><font color="#5a5a5a">; * 10;</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> tmp-stock </font><font color="#660096">&gt;</font><font color="#000000"> tmp-delta [
        </font><font color="#0000aa">set</font><font color="#000000"> volume volume </font><font color="#660096">+</font><font color="#000000"> chvolume-delta
        </font><font color="#0000aa">set</font><font color="#000000"> tmp-stock tmp-stock </font><font color="#660096">-</font><font color="#000000"> tmp-delta
      ]
    ]
  ]
  </font><font color="#0000aa">set</font><font color="#000000"> tmp-stock stock
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> chprice </font><font color="#5a5a5a">;izmenenie cen svoih putej</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> num-tmp num
  </font><font color="#0000aa">ask</font><font color="#000000"> ways </font><font color="#660096">with</font><font color="#000000"> [company </font><font color="#660096">=</font><font color="#000000"> num-tmp] [
    </font><font color="#0000aa">let</font><font color="#000000"> curvol-rel </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> volume </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
      </font><font color="#0000aa">set</font><font color="#000000"> curvol-rel </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> curvolume </font><font color="#660096">/</font><font color="#000000"> volume </font><font color="#5a5a5a">; Zagruzhennost'</font><font color="#000000">
    ]
    </font><font color="#0000aa">if</font><font color="#000000"> curvol-rel </font><font color="#660096">&lt;</font><font color="#000000"> chprice-low [
      </font><font color="#0000aa">set</font><font color="#000000"> price price </font><font color="#660096">-</font><font color="#000000"> chprice-delta
      </font><font color="#0000aa">if</font><font color="#000000"> price </font><font color="#660096">&lt;</font><font color="#000000"> initprice [
        </font><font color="#0000aa">set</font><font color="#000000"> price initprice
      ]
    ]
    </font><font color="#0000aa">if</font><font color="#000000"> curvol-rel </font><font color="#660096">&gt;</font><font color="#000000"> chprice-high [
      </font><font color="#0000aa">set</font><font color="#000000"> price price </font><font color="#660096">+</font><font color="#000000"> chprice-delta
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> vyruchka </font><font color="#5a5a5a">;vyruchka opera</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> num-tmp num
  </font><font color="#0000aa">let</font><font color="#000000"> tkm </font><font color="#660096">sum</font><font color="#000000"> [(price </font><font color="#660096">-</font><font color="#000000"> initprice) </font><font color="#660096">*</font><font color="#000000"> (volume </font><font color="#660096">-</font><font color="#000000"> curvolume)] </font><font color="#660096">of</font><font color="#000000"> ways </font><font color="#660096">with</font><font color="#000000"> [company </font><font color="#660096">=</font><font color="#000000"> num-tmp] </font><font color="#5a5a5a">;Tonnokilometrov</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> stock stock </font><font color="#660096">+</font><font color="#000000"> tkm </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">random-normal</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> vyruchka-otkl</font><font color="#5a5a5a">;* vyruchka-koeff 0.01 * (random 20)</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> do-plots
  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Operators&quot;</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [
    
    </font><font color="#0000aa">let</font><font color="#000000"> tmplist </font><font color="#660096">sort-by</font><font color="#000000"> [[num] </font><font color="#660096">of</font><font color="#000000"> ?1 </font><font color="#660096">&lt;</font><font color="#000000"> [num] </font><font color="#660096">of</font><font color="#000000"> ?2] opers
    </font><font color="#0000aa">foreach</font><font color="#000000"> tmplist [
    </font><font color="#0000aa">ask</font><font color="#000000"> ?  [
      </font><font color="#0000aa">create-temporary-plot-pen</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;(&quot;</font><font color="#000000"> num </font><font color="#963700">&quot;) &quot;</font><font color="#000000"> name)
      </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;(&quot;</font><font color="#000000"> num </font><font color="#963700">&quot;) &quot;</font><font color="#000000"> name)
      </font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> num
    ]
  ]]
  
  </font><font color="#0000aa">ask</font><font color="#000000"> opers [
    </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;(&quot;</font><font color="#000000"> num </font><font color="#963700">&quot;) &quot;</font><font color="#000000"> name)
    </font><font color="#0000aa">plot</font><font color="#000000"> stock
  ]  
  
  </font><font color="#5a5a5a">;set-current-plot &quot;Current-operators&quot;</font><font color="#000000">
  </font><font color="#5a5a5a">;set-current-plot-pen &quot;qq&quot;</font><font color="#000000">
  </font><font color="#5a5a5a">;set-plot-x-range 0 count opers</font><font color="#000000">
  </font><font color="#5a5a5a">;set-histogram-num-bars count opers</font><font color="#000000">
  </font><font color="#5a5a5a">;histogram (list 1 2 5 2 2 2 4);[stock] of opers</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">
</font>
</pre>

</body>
</html>
